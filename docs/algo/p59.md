---
title: 扩展欧几里得
date: 2026.2.17
comments: true
---

# 扩展欧几里得算法（Extended Euclid）笔记

## 1. 欧几里得算法回顾：gcd

目标：求 ($\gcd(a,b)$)。

递推公式：

$[$
$\gcd(a,b)=\gcd(b, a\bmod b)$
$]$

直到 (b=0)，答案是 (a)。

复杂度：

[
$O(\log \min(a,b))$
]

---

## 2. “扩展”了什么：不仅求 gcd，还求系数

扩展欧几里得在求 ($\gcd(a,b)$) 的同时，找出整数 (x,y)，使：

[
$ax+by=\gcd(a,b)$
]

这是裴蜀定理（Bézout）对应的构造算法。

**意义：** 一旦得到这组 (x,y)，很多同余 / 逆元 / 不定方程都能直接做。

---

## 3. 为什么能“假设已经能求出”子问题解？

欧几里得一步：令

[
$a=bq+r,\quad r=a\bmod b$
]

且 $(0\le r<b)$，规模变小，所以递归一定终止在 (b=0) 的基例。

基例：

[
$\gcd(a,0)=a,\quad a\cdot 1+0\cdot 0=a$
]

所以 (x=1,y=0) 可行。

因此在推导中“假设已知 $(bx'+ry'=\gcd(b,r))$”就是递归/归纳假设：先解更小的 ((b,r))，再回代推出 ((a,b))。

---

## 4. 核心回代推导（最重要）

已知：

[
$bx'+ry'=g,\quad g=\gcd(b,r)$
]

又有：

[
$r=a-bq$
]

代入：

[
$bx'+(a-bq)y' = ay' + b(x'-qy')$
]

得到一组对 ((a,b)) 的解：

[
$x=y',\quad y=x'-qy'$
]

而$ (g=\gcd(b,r)=\gcd(a,b))$，所以最终满足：

[
$ax+by=\gcd(a,b)$
]

---

## 5. exgcd 递归模板（思路版）

函数返回 $((g,x,y))$ 表示 $(ax+by=g)$。

* 若 (b=0)：$(g=a,\ x=1,\ y=0)$
* 否则求子问题：$(\text{exgcd}(b,a\bmod b)\Rightarrow(g,x',y'))$
* 回代：

  * $(x=y')$
  * $(y=x'-(a/b)\cdot y')$

复杂度：同 gcd，为

[
$O(\log n)$
]

---

## 6. 同余符号 “(\equiv)” 是什么？

[
$u\equiv v\pmod m$
]

表示$ (m\mid (u-v))$，即存在整数 (k)：

[
$u-v=km$
]

直观理解：**除以 (m) 后余数相同**。

---

## 7. 为什么 (ax\equiv c\pmod m) 等价于 (ax+my=c)？

由同余定义：

[
$ax\equiv c\pmod m \iff m\mid(ax-c)$
]

所以存在整数 (y)：

[
$ax-c=my \iff ax+my=c$
]

这一步把同余问题变成线性不定方程，exgcd 就能上场。

---

## 8. 什么时候用扩展欧几里得？（使用场景）

### 8.1 求模逆元（模数不一定是质数）

求 $(a^{-1}\bmod m)$：

[
$ax\equiv 1\pmod m \iff ax+my=1$ 
]

**有解条件：**

[
$\gcd(a,m)=1$
]

exgcd 给出 (x)，则：

[
$a^{-1}\equiv x\pmod m$
]

优势：不要求 (m) 是质数（对比费马小定理）。

---

### 8.2 解一次不定方程

[
$ax+by=c$
]

设 $(g=\gcd(a,b))$。

* 若 $(c\not\equiv 0\pmod g)$：无解
* 否则 exgcd 求 $(ax_0+by_0=g)$，乘 (c/g) 得一组特解
* 通解：

[
$x=x_0\frac{c}{g}+\frac{b}{g}t,\quad$
$y=y_0\frac{c}{g}-\frac{a}{g}t,\quad$
$t\in\mathbb Z$
]

常见进一步问题：最小正解、区间内解数量、最小 $(\max(x,y))$ 等。

---

### 8.3 解线性同余方程

[
$ax\equiv c\pmod m$
]

等价于：

[
$ax+my=c$
]

设 $(g=\gcd(a,m))$：

* 若 $(c\not\equiv 0\pmod g)$：无解
* 否则化简：

[
$\frac{a}{g}x\equiv \frac{c}{g}\pmod{\frac{m}{g}}$
]

此时$ (\gcd(a/g,m/g)=1)$，可用 exgcd 求逆元得到解。

---

### 8.4 CRT 合并（特别是模数不互质）

合并：

[
$x\equiv a_1\pmod{m_1},\quad x\equiv a_2\pmod{m_2}$
]

化为：

[
$m_1k\equiv (a_2-a_1)\pmod{m_2}$
]

又是线性同余$ (\Rightarrow) exgcd$。

---

## 9. exgcd 的优势总结

* 能给出$ (\gcd) $的同时给出裴蜀系数$ ((x,y))$
* 逆元不要求模数是质数（只需互质）
* 复杂度 $(O(\log n))$，常数小
* 数论题“万能扳手”：同余 / 不定方程$ / CRT$ 都能接上

---

## 10. 常见题型关键词（见到就想 exgcd）

* “求逆元（模数不一定质数）”
* “解 $(ax+by=c)$ / 判断是否有解 / 求最小正解”
* “解 $(ax\equiv c\pmod m)$”
* “合并同余（CRT，尤其不互质）”
* “gcd + 线性组合 / 周期对齐 / 齿轮 / 发车时间同步”

---
