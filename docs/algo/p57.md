---
title: 组合数学与经典计数模型
date: 2026.2.17
comments: true
---

## 隔板法（Stars and Bars）：分配/拆分的万能工具

- 非负整数解个数：

  $$x_1+\cdots+x_m = n,\ x_i\ge 0 \Rightarrow \binom{n+m-1}{m-1}$$

- 正整数解个数：

  $$x_1+\cdots+x_m = n,\ x_i\ge 1 \Rightarrow \binom{n-1}{m-1}$$

- 上界约束（$x_i\le b_i$）通常结合**容斥**：先不管上界用隔板法计数，再对超界变量做减法计数。

## 经典数列与标准计数模型（经常直接套）

### 4.1 错排（Derangement）

- $D_n$：没有元素在原位的排列数

  $$D_n = n!\sum_{k=0}^n \frac{(-1)^k}{k!}$$

- 递推：$$D_n=(n-1)(D_{n-1}+D_{n-2})$$

### 4.2 卡特兰数（Catalan）

常见场景：合法括号序列、栈序列、二叉树形状、路径不越界等

- 定义：

  $$C_n=\frac{1}{n+1}\binom{2n}{n}$$

  - $1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, ...$

- 变体（Ballot/Reflection）：路径计数常用“反射法”得到不越界的组合数差。

### 4.3 斯特林数（Stirling）

- 第二类 $S(n,k)$：把 $n$ 个元素分成 $k$ 个**非空无标号**集合

  $$S(n,k)=S(n-1,k-1)+kS(n-1,k)$$

  常用于“划分成 k 组”的题。

- 第一类（有符号/无符号）与“排列的环结构”相关：把排列分成 kkk 个循环。